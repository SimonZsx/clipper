FROM tensorflow/tensorflow:1.12.0-gpu-py3
RUN apt-get update
RUN apt-get install python3 python3-pip -y
RUN pip3 install numpy
RUN apt-get install libsm6 -y
RUN apt-get install libxext6 libxrender-dev -y
RUN pip3 install --default-timeout=100 opencv-python
RUN pip3 install grpcio
RUN pip3 install protobuf
RUN pip3 install scikit-image
RUN pip3 install Cython
RUN pip3 install pycocotools
RUN pip3 install git+https://github.com/philferriere/cocoapi.git#egg=pycocotools^&subdirectory=PythonAPI
RUN pip3 install tensorflow-gpu
RUN pip3 install keras
RUN pip3 install imgaug
ADD FatigueDetection/container3/app /container/

ADD grpc/app/container_entry.sh /container/
ADD grpc/app/server.py /container/
ADD grpc/app/dag.py /container/
ADD grpc/app/model_pb2_grpc.py /container/
ADD grpc/app/model_pb2.py /container/
ADD grpc/app/proxy_pb2_grpc.py /container/
ADD grpc/app/proxy_pb2.py /container/

EXPOSE 22222

